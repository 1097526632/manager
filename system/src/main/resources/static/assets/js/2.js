webpackJsonp([2],{Ab1q:function(t,e){},Bw6c:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("8+FI"),a=s("/VxO"),o=s("wbDJ"),i=s("jsdL"),c=s("vgQg"),r=s("KvKp"),l={name:"nav-head",data:function(){return{appName:c.a.appName,collapse:!1,fullscreen:!1,name:"",message:2,token:Object(a.b)()}},computed:{username:function(){return this.token.name?this.token.name:this.token.username},photo:function(){return this.token.photo}},methods:{getUserfiles:function(t){return Object(r.e)(t)},handleCommand:function(t){var e=this;"loginout"==t?Object(o.c)().then(function(t){t.code===i.a.success?(Object(a.c)(),e.$router.push("/login")):e.$message.error("登出系统失败")}):"personInfo"==t&&e.$router.push("/personInfo")},collapseChage:function(){this.collapse=!this.collapse,n.a.$emit("collapse",this.collapse)},handleFullScreen:function(){var t=document.documentElement;this.fullscreen?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen(),this.fullscreen=!this.fullscreen}},mounted:function(){document.body.clientWidth<1500&&this.collapseChage()},created:function(){var t=this;n.a.$on("updateToken",function(e){t.token=e})}},u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"nav-head-wrapper"},[n("div",{staticClass:"collapse-btn",on:{click:t.collapseChage}},[n("i",{staticClass:"el-icon-menu"})]),t._v(" "),n("div",{staticClass:"head-content"},[n("div",{staticClass:"logo"},[t._v(t._s(t.appName))])]),t._v(" "),n("div",{staticClass:"header-right"},[n("div",{staticClass:"header-user-con"},[n("div",{staticClass:"btn-fullscreen",on:{click:t.handleFullScreen}},[n("el-tooltip",{attrs:{effect:"dark",content:t.fullscreen?"取消全屏":"全屏",placement:"bottom"}},[n("i",{staticClass:"el-icon-rank"})])],1),t._v(" "),n("el-dropdown",{staticClass:"user-name",on:{command:t.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[t._v("\n                        "+t._s(t.username)+" "),n("i",{staticClass:"el-icon-caret-bottom"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"userhead"}},[t.photo&&""!=t.photo?n("img",{staticClass:"head-img",attrs:{src:t.getUserfiles(t.photo)}}):n("img",{staticClass:"head-img",attrs:{src:s("6vfR")}})]),t._v(" "),n("el-dropdown-item",{attrs:{divided:"",command:"personInfo"}},[t._v("个人信息")]),t._v(" "),n("el-dropdown-item",{attrs:{divided:"",command:"loginout"}},[t._v("退出登录")])],1)],1)],1)])])},staticRenderFns:[]};var d=s("VU/8")(l,u,!1,function(t){s("HKhM")},"data-v-76d785a6",null).exports,m={name:"nav-bar",props:{menuItems:Array}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"nav-bar-wrapper"},t._l(t.menuItems,function(e,n){return s("label",{key:n},[e.children&&e.children.length>0?s("el-submenu",{attrs:{index:e.id}},[s("template",{slot:"title"},[s("i",{staticClass:"fa",class:e.icon?e.icon:"fa-list"}),t._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name))])]),t._v(" "),s("nav-bar",{attrs:{"menu-items":e.children}})],2):s("el-menu-item",{attrs:{data:e,index:e.href?e.href:""}},[s("i",{staticClass:"fa",class:e.icon?e.icon:"fa-list"}),t._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name))])])],1)}),0)},staticRenderFns:[]};var p=s("VU/8")(m,h,!1,function(t){s("PmIn")},"data-v-520fc15a",null).exports,f=s("mvHQ"),v=s.n(f),g={websocket:{},opened:!1,connection:!1,sessionId:c.a.sessionId,userId:Object(a.b)().id,messageQueue:{},registerUrl:{}};function w(){var t=("https:"==window.location.protocol?"wss:":"ws:")+"//"+window.location.hostname+(""!=window.location.port?":"+window.location.port:"")+Object(r.c)("/"+window._BASE_URL+"/ws");g.websocket=new WebSocket(t),g.connection=!0,g.websocket.onopen=function(){g.opened=!0,g.keepAlive=setInterval(function(){g.opened?k("/app/heartJump",{},function(t){}):g.connection||w()},1e4),g.connection=!1,console.log("socket open")},g.websocket.onerror=function(t){console.log(t),b(),g.connection=!1},g.websocket.onmessage=C,g.websocket.onclose=function(){b()},window.onunload=function(){b()},window.onbeforeunload=function(){b()}}function b(){g.opened=!1,g.websocket.close()}function _(){clearInterval(g.keepAlive),b()}function C(t){if(t.data){var e=JSON.parse(t.data);if(e.requestId&&g.messageQueue[e.requestId])g.messageQueue[e.requestId](e),delete g.messageQueue[e.requestId];else{var s=JSON.parse(e.data);g.registerUrl[Object(r.c)(s.url)]&&g.registerUrl[Object(r.c)(s.url)](s)}}}function k(t,e,s){var n={requestId:Object(r.j)(),url:t,sessionId:c.a.sessionId,userId:Object(a.b)().id,data:v()(e)};s&&(g.messageQueue[n.requestId]=s),function(t,e){!function t(e,s){1===g.websocket.readyState?e():setTimeout(function(){t(e,s)},s)}(function(){g.websocket.send(t),void 0!==e&&e()},1e3)}(v()(n))}var $={name:"nav-sidebar",components:{navBar:p},data:function(){return{collapse:!1,menuItems:c.a.menuList,userNum:0}},computed:{onRoutes:function(){return this.$route.path.replace("/","")}},created:function(){var t=this;n.a.$on("collapse",function(e){t.collapse=e}),n.a.$on("systemMenu",function(e){t.menuItems=e});var e,s,a=this;e="/app/noticeUserNum",s=function(t){a.userNum=t.data},g.registerUrl[Object(r.c)("/"+e)]=s}},I={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"nav-sidebar-wrapper"},[e("el-menu",{staticClass:"sidebar-el-menu",attrs:{"default-active":this.onRoutes,collapse:this.collapse,"background-color":"#324157","text-color":"#bfcbd9","active-text-color":"#20a0ff","unique-opened":"",router:""}},[e("nav-bar",{attrs:{menuItems:this.menuItems}})],1),this._v(" "),e("div",{staticClass:"user-num"},[this._v("在线"+this._s(this.userNum)+"人")])],1)},staticRenderFns:[]};var L={name:"tags",data:function(){return{tagsList:[]}},methods:{isActive:function(t){return t===this.$route.fullPath},closeTags:function(t){var e=this.tagsList.splice(t,1)[0],s=this.tagsList[t]?this.tagsList[t]:this.tagsList[t-1];s?e.path===this.$route.fullPath&&this.$router.push(s.path):this.$router.push("/")},closeAll:function(){var t=this.tagsList.filter(function(t){return!t.close});this.tagsList=t,0===this.tagsList.length&&this.$router.push("/")},closeOther:function(){var t=this,e=this.tagsList.filter(function(e){return e.path===t.$route.fullPath||!e.close});this.tagsList=e},setTags:function(t){this.tagsList.some(function(e){return e.path===t.fullPath})||this.tagsList.push({title:t.meta.title,path:t.fullPath,name:t.matched[1].components.default.name,close:!t.meta.noclose||!t.meta.noclose}),n.a.$emit("tags",this.tagsList)},handleTags:function(t){"other"===t?this.closeOther():this.closeAll()}},computed:{showTags:function(){return this.tagsList.length>0}},watch:{$route:function(t,e){this.setTags(t)}},created:function(){var t=this;this.setTags(this.$route),n.a.$on("close_current_tags",function(){for(var e=0,s=t.tagsList.length;e<s;e++){t.tagsList[e].path===t.$route.fullPath&&(e<s-1?t.$router.push(t.tagsList[e+1].path):e>0?t.$router.push(t.tagsList[e-1].path):t.$router.push("/"),t.tagsList.splice(e,1))}})}},F={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.showTags?s("div",{staticClass:"tags-wrapper"},[s("ul",t._l(t.tagsList,function(e,n){return s("li",{key:n,staticClass:"tags-li",class:{active:t.isActive(e.path)}},[s("router-link",{staticClass:"tags-li-title",attrs:{to:e.path}},[t._v("\n        "+t._s(e.title)+"\n      ")]),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.close,expression:"item.close"}],staticClass:"tags-li-icon",on:{click:function(e){return t.closeTags(n)}}},[s("i",{staticClass:"el-icon-close"})])],1)}),0),t._v(" "),s("div",{staticClass:"tags-close-box"},[s("el-dropdown",{staticStyle:{height:"100%"},on:{command:t.handleTags}},[s("el-button",{staticStyle:{"border-radius":"0",height:"100%"},attrs:{size:"mini",type:"primary"}},[t._v("\n        标签选项"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown",size:"small"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"other"}},[t._v("关闭其他")]),t._v(" "),s("el-dropdown-item",{attrs:{command:"all"}},[t._v("关闭所有")])],1)],1)],1)]):t._e()},staticRenderFns:[]};var O={name:"main",components:{navHead:d,navSidebar:s("VU/8")($,I,!1,function(t){s("Ab1q")},"data-v-d73b4696",null).exports,tags:s("VU/8")(L,F,!1,function(t){s("u9Ez")},"data-v-56203ca4",null).exports},computed:{showTags:function(){var t=Object(a.b)();return!t.personality||1===JSON.parse(t.personality).menuType}},data:function(){return{tagsList:[],collapse:!1}},created:function(){var t=this;n.a.$on("collapse",function(e){t.collapse=e}),n.a.$on("tags",function(e){for(var s=[],n=0,a=e.length;n<a;n++)e[n].name&&s.push(e[n].name);t.tagsList=s});try{w(),k("user/register",{})}catch(t){console.log(t)}},beforeDestroy:function(){_()}},S={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main-wrapper"},[s("nav-head"),t._v(" "),s("nav-sidebar"),t._v(" "),s("div",{staticClass:"content-box",class:{"content-collapse":t.collapse,tags:t.showTags}},[t.showTags?s("tags"):t._e(),t._v(" "),s("div",{staticClass:"content"},[s("transition",{attrs:{name:"move",mode:"out-in"}},[s("keep-alive",{attrs:{include:t.tagsList}},[s("router-view")],1)],1)],1)],1)],1)},staticRenderFns:[]};var q=s("VU/8")(O,S,!1,function(t){s("vPUU")},"data-v-0ecbf6e8",null);e.default=q.exports},HKhM:function(t,e){},PmIn:function(t,e){},u9Ez:function(t,e){},vPUU:function(t,e){}});