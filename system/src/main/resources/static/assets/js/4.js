webpackJsonp([4],{"6+sr":function(e,t,a){"use strict";var r=a("BO1k"),n=a.n(r),i=a("KvKp"),l=a("wbDJ"),o={name:"treeTable",props:{url:String,columns:{type:Array,default:function(){return[]}},operator:{type:Object,default:function(){return{edit:!0,view:!0,del:!0}}},pid:{type:String,default:function(){return"pid"}},id:{type:String,default:function(){return"id"}},lazy:{type:Boolean,default:function(){return!1}}},data:function(){return{data:[],initData:{},updateTable:Math.random()}},methods:{setParams:function(e){this.loadDataInfo(e)},handleView:function(e,t){this.$emit("handleView",t,e)},handleEdit:function(e,t){this.$emit("handleEdit",t,e)},handleDelete:function(e,t){this.$emit("handleDelete",t,e)},addSub:function(e,t){this.$emit("addSub",t,e)},dbclick:function(e,t,a){this.$emit("dbclick",e,t,a)},loadDataInfo:function(e){var t=this;e=e||{},Object(l.e)(this,this.url,e,function(e){var a=e.data.records?e.data.records:e.data;if(t.lazy){t.data=[];var r=!0,l=!1,o=void 0;try{for(var s,c=n()(a);!(r=(s=c.next()).done);r=!0){var d=s.value;d.hasChildren=!0,t.data.push(d),t.initData[d[t.id]]=d}}catch(e){l=!0,o=e}finally{try{!r&&c.return&&c.return()}finally{if(l)throw o}}}else{t.initData={};var u=!0,f=!1,p=void 0;try{for(var m,h=n()(a);!(u=(m=h.next()).done);u=!0){var b=m.value;t.initData[b[t.id]]=b}}catch(e){f=!0,p=e}finally{try{!u&&h.return&&h.return()}finally{if(f)throw p}}t.data=Object(i.i)(a,{id:t.id,pid:t.pid})}})},loadData:function(e,t,a){var r=this,i={};i[this.pid]=e[this.id],Object(l.e)(this,this.url,i,function(t){var i=t.data.records?t.data.records:t.data;if(i&&0!==i.length){var l=!0,o=!1,s=void 0;try{for(var c,d=n()(i);!(l=(c=d.next()).done);l=!0){var u=c.value;u.hasChildren=!0,u.__parent=e}}catch(e){o=!0,s=e}finally{try{!l&&d.return&&d.return()}finally{if(o)throw s}}console.log(a),a(i)}else r.$set(e,"hasChildren",!1),r.$set(e,"children",null),r.updateTable=Math.random()})}},mounted:function(){this.loadDataInfo()}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tree-table-wrapper"},[e.lazy?a("el-table",{ref:"treetable",attrs:{data:e.data,border:"","row-key":"id",lazy:"",load:e.loadData},on:{"row-dblclick":e.dbclick}},[e._l(e.columns,function(t,r){return a("el-table-column",{key:r,attrs:{label:t.label,width:t.width},scopedSlots:e._u([{key:"default",fn:function(r){return[t.render?a("span",{domProps:{innerHTML:e._s(t.render(r))}}):a("span",[e._v("\n        "+e._s(r.row[t.name])+"\n      ")])]}}],null,!1,2398413765)})}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.operator.render?a("span",{domProps:{innerHTML:e._s(e.operator.render(t))}}):a("span",[e.operator.edit?a("el-button",{attrs:{type:"success",title:"编辑",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-edit"})]):e.operator.view?a("el-button",{attrs:{type:"success",title:"查看",circle:""},on:{click:function(a){return e.handleView(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-search"})]):e._e(),e._v(" "),e.operator.del?a("el-button",{attrs:{type:"danger",title:"删除",circle:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-delete"})]):e._e(),e._v(" "),e.operator.edit?a("el-button",{attrs:{size:"mini",type:"primary",title:"添加下级",circle:""},on:{click:function(a){return e.addSub(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-plus"})]):e._e()],1)]}}],null,!1,3612830426)})],2):a("el-table",{attrs:{data:e.data,border:"","row-key":"id"},on:{"row-dblclick":e.dbclick}},[e._l(e.columns,function(t,r){return a("el-table-column",{key:r,attrs:{label:t.label,width:t.width},scopedSlots:e._u([{key:"default",fn:function(r){return[t.render?a("span",{domProps:{innerHTML:e._s(t.render(r))}}):a("span",[e._v("\n        "+e._s(r.row[t.name])+"\n      ")])]}}])})}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.operator.render?a("span",{domProps:{innerHTML:e._s(e.operator.render(t))}}):a("span",[e.operator.edit?a("el-button",{attrs:{type:"success",title:"编辑",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-edit"})]):e.operator.view?a("el-button",{attrs:{type:"success",title:"查看",circle:""},on:{click:function(a){return e.handleView(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-search"})]):e._e(),e._v(" "),e.operator.del?a("el-button",{attrs:{type:"danger",title:"删除",circle:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-delete"})]):e._e(),e._v(" "),e.operator.edit?a("el-button",{attrs:{size:"mini",type:"primary",title:"添加下级",circle:""},on:{click:function(a){return e.addSub(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-plus"})]):e._e()],1)]}}])})],2)],1)},staticRenderFns:[]};var c=a("VU/8")(o,s,!1,function(e){a("PZAX")},"data-v-637a6e15",null);t.a=c.exports},MDLP:function(e,t){},PDS2:function(e,t){},PZAX:function(e,t){},fLBt:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("woOf"),n=a.n(r),i=a("wbDJ"),l=a("2ay1"),o=a("qxtv"),s=(a("jsdL"),{name:"form",components:{TreeDialog:a("Nqf6").a},computed:{typeDict:function(){return Object(o.a)("sys_office_type")}},data:function(){return{title:"",dialogVisible:!1,treeVisiable:!1,treeOpen:!1,treeDialogOpen:!1,rootNode:{},showFooter:!0,form:{},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]},treeProps:{label:"name",children:"children",isLeaf:"leaf"}}},methods:{confirmInfo:function(){this.form.__parent=null,this.form.children=null,Object(i.h)(this,"form","sys/sysOffice/save",this.form)},hasBtnPermission:function(e){return Object(l.b)(e)},showDialog:function(e,t,a,r){this.title=e,this.dialogVisible=t,this.form=n()({},a),this.showFooter=!r||0===r},showParent:function(){this.$refs.treeDialog.showDialog("选择上级机构")},treeClosed:function(){this.treeDialogOpen=!1,this.rootNode.node.childNodes=[]},closeFormDialog:function(){this.$refs.form.resetFields()},confirmParent:function(e){if(e){if(e.data.id===this.form.id)return this.$message.warning("上级机构不能选择自身"),!1;this.$set(this.form,"parentId",e.data.id),this.$set(this.form,"parentName",e.data.name)}}}}),c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.title,visible:e.dialogVisible,width:"70%","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},closed:e.closeFormDialog}},[a("div",{staticClass:"form-wrapper"},[a("el-form",{ref:"form",class:!1===e.showFooter?"view":"",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"上级机构:",prop:"parentName"}},[a("el-input",{attrs:{readonly:!0},nativeOn:{click:function(t){return e.showParent()}},model:{value:e.form.parentName,callback:function(t){e.$set(e.form,"parentName",t)},expression:"form.parentName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"名称:",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"机构类型:",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.typeDict,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"排序:",prop:"sort"}},[a("el-input",{model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"邮政编码:",prop:"zipCode"}},[a("el-input",{model:{value:e.form.zipCode,callback:function(t){e.$set(e.form,"zipCode",t)},expression:"form.zipCode"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"是否启用:",prop:"useable"}},[a("el-radio-group",{model:{value:e.form.useable,callback:function(t){e.$set(e.form,"useable",t)},expression:"form.useable"}},[a("el-radio",{attrs:{label:"1"}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:"0"}},[e._v("禁用")])],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"联系地址:",prop:"address"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1)],1)],1)],1)],1),e._v(" "),e.showFooter?a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.confirmInfo()}}},[e._v("确 定")])],1):e._e(),e._v(" "),a("tree-dialog",{ref:"treeDialog",attrs:{"load-url":"sys/sysOffice/loadList",rootParams:{parentId:"o_0"}},on:{treeConfirm:e.confirmParent}})],1)},staticRenderFns:[]};var d={name:"list",components:{formInfo:a("VU/8")(s,c,!1,function(e){a("MDLP")},"data-v-656a6282",null).exports,treeTable:a("6+sr").a},data:function(){return{tableData:[],params:{},columns:[{name:"name",label:"名称"},{name:"type",label:"类型",render:function(e){return Object(o.b)("sys_office_type",e.row.type)}},{name:"address",label:"地址"},{name:"sort",label:"排序"},{name:"zipCode",label:"邮编"},{name:"usable",label:"状态",render:function(e){return"1"===e.row.useable?"启用":"禁用"}}],operator:{view:Object(l.b)("view:sys:sysOffice"),edit:Object(l.b)("edit:sys:sysOffice"),del:Object(l.b)("del:sys:sysOffice")},url:"sys/sysOffice/loadList"}},methods:{handlePageChange:function(e){this.loadList()},hasBtnPermission:function(e){return Object(l.b)(e)},loadList:function(){this.$refs.treetable.setParams(this.params)},edit:function(e,t,a){if(this.hasBtnPermission("edit:sys:sysOffice")){var r=(a?"查看":e&&e.id?"编辑":"新增")+"机构表";e&&e.__parent&&(e.parentName=e.__parent?e.__parent.name:""),this.$refs.formInfo.showDialog(r,!0,e||{useable:"1",type:"1",sort:30},a?1:0)}else this.$message.warning("无操作权限")},deleteInfo:function(e){if(this.hasBtnPermission("del:sys:sysOffice")){var t=n()({},e);t.__parent=null,t.children=null,Object(i.d)(this,"sys/sysOffice/delete",t)}else this.$message.warning("无操作权限")},addSub:function(e,t){this.edit({parentId:e.id,parentName:e.name,sort:e.child&&e.child.length>0?parseInt(e.child[e.child.length-1].sort)+30:30,useable:"1",type:e.type})},updateData:function(e){this.loadList()},dbclick:function(e,t,a){var r=!0;this.hasBtnPermission("edit:sys:sysOffice")&&(r=!1),this.edit(e,r)}},mounted:function(){}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-wrapper"},[a("div",{staticClass:"params-wrapper"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"关键值:"}},[a("el-input",{attrs:{placeholder:"关键值查询"},model:{value:e.params.keyName,callback:function(t){e.$set(e.params,"keyName",t)},expression:"params.keyName"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary","native-type":"submit"},on:{click:function(t){return e.loadList()}}},[a("i",{staticClass:"el-icon-search"}),e._v(" 查询")])],1),e._v(" "),a("div",{staticClass:"oper-wrapper"},[e.hasBtnPermission("edit:sys:sysOffice")?a("el-button",{attrs:{type:"success",title:"新增"},on:{click:function(t){return e.edit()}}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 新增")]):e._e()],1)],1)],1),e._v(" "),a("tree-table",{ref:"treetable",attrs:{pid:"parentId",columns:e.columns,operator:e.operator,url:e.url},on:{handleEdit:e.edit,handleView:e.edit,handleDelete:e.deleteInfo,addSub:e.addSub,dbclick:e.dbclick,updateData:e.updateData}}),e._v(" "),a("form-info",{ref:"formInfo",on:{updateData:e.updateData}})],1)},staticRenderFns:[]};var f=a("VU/8")(d,u,!1,function(e){a("PDS2")},"data-v-79d76134",null);t.default=f.exports}});